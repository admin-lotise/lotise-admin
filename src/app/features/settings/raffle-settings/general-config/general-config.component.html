<div class="general-config-container">
  <!-- Success Message -->
  @if (successMessage()) {
    <div class="alert alert-success">
      <i class="fas fa-check-circle"></i>
      <span>{{ successMessage() }}</span>
      <button class="close-btn" (click)="successMessage.set(null)">
        <i class="fas fa-times"></i>
      </button>
    </div>
  }

  <!-- Error Message -->
  @if (errorMessage()) {
    <div class="alert alert-error">
      <i class="fas fa-exclamation-circle"></i>
      <span>{{ errorMessage() }}</span>
      <button class="close-btn" (click)="errorMessage.set(null)">
        <i class="fas fa-times"></i>
      </button>
    </div>
  }

  <!-- Form -->
  <form [formGroup]="generalForm" (ngSubmit)="onSubmit()" class="settings-form">
    <div class="form-section">
      <h2 class="section-title">
        <i class="fas fa-sliders-h"></i>
        Parámetros Generales
      </h2>

      <!-- Minutes to Close -->
      <div class="form-group">
        <label for="minutesToClose" class="form-label">
          <i class="fas fa-clock"></i>
          Minutos para cerrar antes del sorteo
          <span class="required">*</span>
        </label>
        <input
          type="number"
          id="minutesToClose"
          formControlName="minutesToClose"
          class="form-control"
          [class.is-invalid]="minutesToClose?.invalid && minutesToClose?.touched"
          min="5"
          max="120"
          placeholder="30"
        />
        @if (minutesToClose?.invalid && minutesToClose?.touched) {
          <div class="error-message">
            @if (minutesToClose?.errors?.['required']) {
              <span>Este campo es requerido</span>
            }
            @if (minutesToClose?.errors?.['min']) {
              <span>Debe ser al menos 5 minutos</span>
            }
            @if (minutesToClose?.errors?.['max']) {
              <span>No puede superar los 120 minutos</span>
            }
          </div>
        }
        <small class="form-hint">
          Tiempo antes del sorteo en que se deja de vender boletos
        </small>
      </div>

      <!-- Tickets Per Page -->
      <div class="form-group">
        <label for="ticketsPerPage" class="form-label">
          <i class="fas fa-ticket-alt"></i>
          Boletos por página
          <span class="required">*</span>
        </label>
        <input
          type="number"
          id="ticketsPerPage"
          formControlName="ticketsPerPage"
          class="form-control"
          [class.is-invalid]="ticketsPerPage?.invalid && ticketsPerPage?.touched"
          min="10"
          max="200"
          placeholder="50"
        />
        @if (ticketsPerPage?.invalid && ticketsPerPage?.touched) {
          <div class="error-message">
            @if (ticketsPerPage?.errors?.['required']) {
              <span>Este campo es requerido</span>
            }
            @if (ticketsPerPage?.errors?.['min']) {
              <span>Debe ser al menos 10 boletos</span>
            }
            @if (ticketsPerPage?.errors?.['max']) {
              <span>No puede superar los 200 boletos</span>
            }
          </div>
        }
        <small class="form-hint">
          Cantidad de boletos que se muestran por página en la vista de selección
        </small>
      </div>

      <!-- Lucky Machine Options -->
      <div class="form-group">
        <label for="luckyMachineOptions" class="form-label">
          <i class="fas fa-dice"></i>
          Opciones de Máquina de la Suerte
          <span class="required">*</span>
        </label>
        <input
          type="text"
          id="luckyMachineOptions"
          formControlName="luckyMachineOptions"
          class="form-control"
          [class.is-invalid]="luckyMachineOptions?.invalid && luckyMachineOptions?.touched"
          placeholder="1,2,3,4,5,6,7,8,9,10"
        />
        @if (luckyMachineOptions?.invalid && luckyMachineOptions?.touched) {
          <div class="error-message">
            <span>Este campo es requerido</span>
          </div>
        }
        <small class="form-hint">
          Números de boletos separados por comas que el cliente puede elegir con "Máquina de la Suerte"
        </small>
      </div>

      <!-- Submit Button -->
      <div class="form-actions">
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="generalForm.invalid || isLoading"
        >
          @if (isLoading) {
            <i class="fas fa-spinner fa-spin"></i>
            <span>Guardando...</span>
          } @else {
            <i class="fas fa-save"></i>
            <span>Guardar Configuración General</span>
          }
        </button>
      </div>
    </div>
  </form>
</div>