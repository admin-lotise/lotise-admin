<div class="social-media-container">
  <!-- Success Message -->
  @if (successMessage()) {
    <div class="alert alert-success">
      <i class="fas fa-check-circle"></i>
      <span>{{ successMessage() }}</span>
      <button class="close-btn" (click)="successMessage.set(null)">
        <i class="fas fa-times"></i>
      </button>
    </div>
  }

  <!-- Error Message -->
  @if (errorMessage()) {
    <div class="alert alert-error">
      <i class="fas fa-exclamation-circle"></i>
      <span>{{ errorMessage() }}</span>
      <button class="close-btn" (click)="errorMessage.set(null)">
        <i class="fas fa-times"></i>
      </button>
    </div>
  }

  <!-- Header -->
  <div class="section-header">
    <div class="header-content">
      <h2 class="section-title">
        <i class="fas fa-share-alt"></i>
        Redes Sociales
      </h2>
      <p class="section-subtitle">
        Configura los enlaces a tus redes sociales para que aparezcan en la página de rifas
      </p>
    </div>
  </div>

  <!-- Form -->
  <form [formGroup]="socialMediaForm" (ngSubmit)="onSubmit()">
    <div class="social-networks-grid">
      @for (network of socialNetworks; track network.key) {
        <div class="social-card">
          <!-- Icon & Name -->
          <div class="social-header">
            <div class="social-icon" [style.background-color]="network.color">
              <i [class]="network.icon"></i>
            </div>
            <div class="social-info">
              <h3 class="social-name">{{ network.name }}</h3>
              @if (hasValidUrl(network.key)) {
                <span class="status-badge active">
                  <i class="fas fa-check-circle"></i>
                  Configurado
                </span>
              } @else {
                <span class="status-badge inactive">
                  <i class="fas fa-circle"></i>
                  No configurado
                </span>
              }
            </div>
          </div>

          <!-- Input -->
          <div class="form-group">
            <div class="input-wrapper">
              <input
                type="url"
                [formControlName]="network.key"
                class="form-control"
                [class.is-invalid]="getControl(network.key)?.invalid && getControl(network.key)?.touched"
                [class.has-value]="hasValidUrl(network.key)"
                [placeholder]="network.placeholder"
              />
              @if (hasValidUrl(network.key)) {
                <button
                  type="button"
                  class="clear-btn"
                  (click)="clearField(network.key)"
                  title="Limpiar"
                >
                  <i class="fas fa-times"></i>
                </button>
              }
            </div>

            @if (getControl(network.key)?.invalid && getControl(network.key)?.touched) {
              <div class="error-message">
                @if (getControl(network.key)?.errors?.['pattern']) {
                  <span>URL no válida para {{ network.name }}</span>
                }
              </div>
            }

            <!-- Preview Link -->
            @if (hasValidUrl(network.key)) {
              <a
                [href]="getControl(network.key)?.value"
                target="_blank"
                class="preview-link"
              >
                <i class="fas fa-external-link-alt"></i>
                Ver perfil
              </a>
            }
          </div>
        </div>
      }
    </div>

    <!-- Info Box -->
    <div class="info-box">
      <i class="fas fa-info-circle"></i>
      <div>
        <strong>¿Cómo configurar?</strong>
        <ul>
          <li>Copia la URL completa de tu perfil en cada red social</li>
          <li>Asegúrate de incluir <code>https://</code> al inicio</li>
          <li>Las redes configuradas aparecerán como íconos en tu página de rifas</li>
          <li>Puedes dejar vacías las redes que no uses</li>
        </ul>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="form-actions">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="socialMediaForm.invalid || isSaving()"
      >
        @if (isSaving()) {
          <i class="fas fa-spinner fa-spin"></i>
          <span>Guardando...</span>
        } @else {
          <i class="fas fa-save"></i>
          <span>Guardar Redes Sociales</span>
        }
      </button>
    </div>
  </form>
</div>